<pre style='color:#000000;background:#ffffff;'><span style='color:#800000; font-weight:bold; '>from</span> tkinter <span style='color:#800000; font-weight:bold; '>import</span> filedialog
<span style='color:#800000; font-weight:bold; '>import</span> tkinter <span style='color:#800000; font-weight:bold; '>as</span> tk
<span style='color:#800000; font-weight:bold; '>from</span> PIL <span style='color:#800000; font-weight:bold; '>import</span> Image<span style='color:#808030; '>,</span> ImageFont<span style='color:#808030; '>,</span> ImageDraw<span style='color:#808030; '>,</span> ImageTk
<span style='color:#800000; font-weight:bold; '>import</span> cv2
<span style='color:#800000; font-weight:bold; '>import</span> numpy <span style='color:#800000; font-weight:bold; '>as</span> np
<span style='color:#800000; font-weight:bold; '>import</span> time
<span style='color:#800000; font-weight:bold; '>import</span> os

CONFIDENCE <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.5</span> <span style='color:#696969; '>#taux de confiance (50%)</span>
SCORE_THRESHOLD <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.5</span>
IOU_THRESHOLD <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.5</span>
nb <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span> <span style='color:#696969; '># compteur images</span>
blurRate <span style='color:#808030; '>=</span> <span style='color:#008c00; '>45</span> <span style='color:#696969; '>#taux de floutage</span>
defaultSize <span style='color:#808030; '>=</span> <span style='color:#008c00; '>500</span> <span style='color:#696969; '>#taille par defaut pour affichage</span>
smallfontSize <span style='color:#808030; '>=</span> <span style='color:#008c00; '>25</span> <span style='color:#696969; '>#taille de la police pour l'image reduite</span>

root <span style='color:#808030; '>=</span> tk<span style='color:#808030; '>.</span>Tk<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># fenetre d'affichage</span>
currentPath <span style='color:#808030; '>=</span> os<span style='color:#808030; '>.</span>getcwd<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#44aadd; '>+</span><span style='color:#0000e6; '>"/"</span> <span style='color:#696969; '># chemin actuel dans lequel se situe le programme</span>
<span style='color:#696969; '># network configuration</span>
config_path <span style='color:#808030; '>=</span> currentPath<span style='color:#44aadd; '>+</span><span style='color:#0000e6; '>"yolov3.cfg"</span> <span style='color:#696969; '># organisation du reseau de neurones</span>
<span style='color:#696969; '># YOLO net weights</span>
weights_path <span style='color:#808030; '>=</span> currentPath<span style='color:#44aadd; '>+</span><span style='color:#0000e6; '>"yolov3.weights"</span> <span style='color:#696969; '># hierarchie du reseau de neurones</span>
<span style='color:#696969; '>#  coco class labels (objects)</span>
labels <span style='color:#808030; '>=</span> <span style='color:#400000; '>open</span><span style='color:#808030; '>(</span>currentPath<span style='color:#44aadd; '>+</span><span style='color:#0000e6; '>"coco.names"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>read<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>strip<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>split<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"</span><span style='color:#0f69ff; '>\n</span><span style='color:#0000e6; '>"</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># noms des objets detectables</span>

fontFileName<span style='color:#808030; '>=</span>currentPath<span style='color:#44aadd; '>+</span><span style='color:#0000e6; '>'RobotoSlab-Regular.ttf'</span> <span style='color:#696969; '># police pour affichage sur l'image</span>
loadedFont <span style='color:#808030; '>=</span> ImageFont<span style='color:#808030; '>.</span>truetype<span style='color:#808030; '>(</span>fontFileName<span style='color:#808030; '>,</span>smallfontSize<span style='color:#808030; '>)</span> <span style='color:#696969; '># chargement de la police pour affichage dans la fenetre</span>
net <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>dnn<span style='color:#808030; '>.</span>readNetFromDarknet<span style='color:#808030; '>(</span>config_path<span style='color:#808030; '>,</span> weights_path<span style='color:#808030; '>)</span> <span style='color:#696969; '># initialisation du reseau de neurones</span>

<span style='color:#696969; '>#fonction pour calculer le ratio de reduction d'une image</span>
<span style='color:#800000; font-weight:bold; '>def</span> calcRatio<span style='color:#808030; '>(</span>origw<span style='color:#808030; '>,</span> origh<span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
    ratio <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
    <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span>origw <span style='color:#44aadd; '>>=</span> origh<span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
        ratio <span style='color:#808030; '>=</span> origw<span style='color:#44aadd; '>/</span>origh
        nwidth <span style='color:#808030; '>=</span> defaultSize
        nheight <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>nwidth<span style='color:#44aadd; '>/</span>ratio<span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>elif</span><span style='color:#808030; '>(</span>origh <span style='color:#44aadd; '>></span> origw<span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
        ratio <span style='color:#808030; '>=</span> origh<span style='color:#44aadd; '>/</span>origw
        nheight <span style='color:#808030; '>=</span> defaultSize
        nwidth <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>nheight<span style='color:#44aadd; '>/</span>ratio<span style='color:#808030; '>)</span>

    <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#808030; '>(</span>ratio<span style='color:#808030; '>,</span>nwidth<span style='color:#808030; '>,</span>nheight<span style='color:#808030; '>)</span>

<span style='color:#696969; '>#fonction de detection</span>
<span style='color:#800000; font-weight:bold; '>def</span> runDetection<span style='color:#808030; '>(</span>imgFolder<span style='color:#808030; '>,</span>direction<span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
    <span style='color:#800000; font-weight:bold; '>global</span> nb <span style='color:#696969; '># acces au compteur d'images pour modificiation de la valeur</span>
    boxes<span style='color:#808030; '>,</span> confidences<span style='color:#808030; '>,</span> class_ids <span style='color:#808030; '>=</span> <span style='color:#808030; '>[</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#808030; '>]</span>

    <span style='color:#696969; '># en arriere ou en avant dans la liste des images (filelist)</span>
    <span style='color:#800000; font-weight:bold; '>if</span> direction <span style='color:#44aadd; '>&lt;</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>:</span>
        <span style='color:#800000; font-weight:bold; '>if</span> nb <span style='color:#44aadd; '>></span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>
            nb<span style='color:#44aadd; '>-</span><span style='color:#808030; '>=</span><span style='color:#008c00; '>2</span>
        <span style='color:#800000; font-weight:bold; '>else</span><span style='color:#808030; '>:</span>
            nb<span style='color:#808030; '>=</span><span style='color:#400000; '>len</span><span style='color:#808030; '>(</span>filelist<span style='color:#808030; '>)</span><span style='color:#44aadd; '>-</span><span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>elif</span> direction <span style='color:#44aadd; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>:</span>
        <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span>nb <span style='color:#44aadd; '>>=</span> <span style='color:#400000; '>len</span><span style='color:#808030; '>(</span>filelist<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
            nb <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>

    imgTarget <span style='color:#808030; '>=</span> imgFolder<span style='color:#44aadd; '>+</span><span style='color:#0000e6; '>"/"</span><span style='color:#44aadd; '>+</span>filelist<span style='color:#808030; '>[</span>nb<span style='color:#808030; '>]</span> <span style='color:#696969; '>#le chemin de l'image actuelle a afficher</span>
    <span style='color:#800000; font-weight:bold; '>print</span><span style='color:#808030; '>(</span>imgTarget<span style='color:#808030; '>)</span>

    image <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>imread<span style='color:#808030; '>(</span>imgTarget<span style='color:#808030; '>)</span> <span style='color:#696969; '># ouverture de l'image</span>

    <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span>image <span style='color:#800000; font-weight:bold; '>is</span> np<span style='color:#808030; '>.</span>ndarray<span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
        <span style='color:#800000; font-weight:bold; '>print</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"EMPTY PIC"</span><span style='color:#808030; '>)</span>
        <span style='color:#800000; font-weight:bold; '>return</span>

    fullImage <span style='color:#808030; '>=</span> image<span style='color:#808030; '>.</span>copy<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># copie de l'image originale (pour besoins de sauvegarde)</span>

    origh<span style='color:#808030; '>,</span> origw <span style='color:#808030; '>=</span> image<span style='color:#808030; '>.</span>shape<span style='color:#808030; '>[</span><span style='color:#808030; '>:</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span> <span style='color:#696969; '>#taille originale de l'image</span>

    <span style='color:#696969; '>#calcul du ratio de reduction (pr reduire la plus grne longeur a 500px)</span>
    ratio<span style='color:#808030; '>,</span> nwidth<span style='color:#808030; '>,</span> nheight <span style='color:#808030; '>=</span> calcRatio<span style='color:#808030; '>(</span>origw<span style='color:#808030; '>,</span>origh<span style='color:#808030; '>)</span>

    <span style='color:#696969; '>#reduction de l'image</span>
    image <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>resize<span style='color:#808030; '>(</span>image<span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span>nwidth<span style='color:#808030; '>,</span> nheight<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>

    <span style='color:#696969; '># tranformation de l'image reduite en "blob" pur traitement par le reseau de neurones</span>
    blob <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>dnn<span style='color:#808030; '>.</span>blobFromImage<span style='color:#808030; '>(</span>image<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#44aadd; '>/</span><span style='color:#008000; '>255.0</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span><span style='color:#008c00; '>416</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>416</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> swapRB<span style='color:#808030; '>=</span><span style='color:#074726; '>True</span><span style='color:#808030; '>,</span> crop<span style='color:#808030; '>=</span><span style='color:#074726; '>False</span><span style='color:#808030; '>)</span>
    image<span style='color:#808030; '>.</span>shape<span style='color:#808030; '>:</span> <span style='color:#808030; '>(</span><span style='color:#008c00; '>1200</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1800</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>)</span> <span style='color:#696969; '>#?</span>
    blob<span style='color:#808030; '>.</span>shape<span style='color:#808030; '>:</span> <span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>416</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>416</span><span style='color:#808030; '>)</span> <span style='color:#696969; '>#?</span>

    <span style='color:#696969; '># on envoie le blob au reseau de neurones (en input)</span>
    net<span style='color:#808030; '>.</span>setInput<span style='color:#808030; '>(</span>blob<span style='color:#808030; '>)</span>

    <span style='color:#696969; '>#obtention des differentes couches du reseau</span>
    ln <span style='color:#808030; '>=</span> net<span style='color:#808030; '>.</span>getLayerNames<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
    ln <span style='color:#808030; '>=</span> <span style='color:#808030; '>[</span>ln<span style='color:#808030; '>[</span>i<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span> <span style='color:#44aadd; '>-</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span> <span style='color:#800000; font-weight:bold; '>for</span> i <span style='color:#800000; font-weight:bold; '>in</span> net<span style='color:#808030; '>.</span>getUnconnectedOutLayers<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>]</span> <span style='color:#696969; '># this shit fails on opencv4.5.4 </span><span style='color:#ffffff; background:#808000; '>!!!</span>
    layer_outputs <span style='color:#808030; '>=</span> net<span style='color:#808030; '>.</span>forward<span style='color:#808030; '>(</span>ln<span style='color:#808030; '>)</span> <span style='color:#696969; '># on effectue la detection d'objets</span>

    <span style='color:#800000; font-weight:bold; '>print</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"detection done.."</span><span style='color:#808030; '>)</span>

    <span style='color:#696969; '>#pour chaque valeurs retournee par les couches du reseau de neurones..</span>
    <span style='color:#800000; font-weight:bold; '>for</span> output <span style='color:#800000; font-weight:bold; '>in</span> layer_outputs<span style='color:#808030; '>:</span>
        <span style='color:#696969; '>#pour chaque detection dans chaque valeur..</span>
        <span style='color:#800000; font-weight:bold; '>for</span> detection <span style='color:#800000; font-weight:bold; '>in</span> output<span style='color:#808030; '>:</span>
            scores <span style='color:#808030; '>=</span> detection<span style='color:#808030; '>[</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>:</span><span style='color:#808030; '>]</span> <span style='color:#696969; '># informations sur la detection</span>
            class_id <span style='color:#808030; '>=</span> np<span style='color:#808030; '>.</span>argmax<span style='color:#808030; '>(</span>scores<span style='color:#808030; '>)</span> <span style='color:#696969; '>#extraction de l'ID detecte (quel objet?)</span>
            confidence <span style='color:#808030; '>=</span> scores<span style='color:#808030; '>[</span>class_id<span style='color:#808030; '>]</span> <span style='color:#696969; '>#extraction du taux de confiance dans la detection effectuee</span>

            <span style='color:#696969; '># si le tqux de confiance est superieur au niveau minimum estime (50%)</span>
            <span style='color:#800000; font-weight:bold; '>if</span> confidence <span style='color:#44aadd; '>></span> CONFIDENCE<span style='color:#808030; '>:</span>
                <span style='color:#696969; '># obtention des coordoonees</span>
                box <span style='color:#808030; '>=</span> detection<span style='color:#808030; '>[</span><span style='color:#808030; '>:</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span> <span style='color:#44aadd; '>*</span> np<span style='color:#808030; '>.</span>array<span style='color:#808030; '>(</span><span style='color:#808030; '>[</span>nwidth<span style='color:#808030; '>,</span> nheight<span style='color:#808030; '>,</span> nwidth<span style='color:#808030; '>,</span> nheight<span style='color:#808030; '>]</span><span style='color:#808030; '>)</span>
                <span style='color:#808030; '>(</span>centerX<span style='color:#808030; '>,</span> centerY<span style='color:#808030; '>,</span> width<span style='color:#808030; '>,</span> height<span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span> box<span style='color:#808030; '>.</span>astype<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"int"</span><span style='color:#808030; '>)</span> <span style='color:#696969; '>## obtention des coordoonees du centre de l'objet detecte et de sa taille</span>
                coord_x <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>centerX <span style='color:#44aadd; '>-</span> <span style='color:#808030; '>(</span>width <span style='color:#44aadd; '>/</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># coordonnee x du point haut gauche</span>
                coord_y <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>centerY <span style='color:#44aadd; '>-</span> <span style='color:#808030; '>(</span>height <span style='color:#44aadd; '>/</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># coordonnee y du point haut gauche</span>
                boxes<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#808030; '>[</span>coord_x<span style='color:#808030; '>,</span> coord_y<span style='color:#808030; '>,</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>width<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>height<span style='color:#808030; '>)</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># ajout des coordoonees et taille de l'objet a la liste des objets</span>
                confidences<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span><span style='color:#400000; '>float</span><span style='color:#808030; '>(</span>confidence<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># ajout du taux de confiance pour cet objet a a liste des taux de confiance</span>
                class_ids<span style='color:#808030; '>.</span>append<span style='color:#808030; '>(</span>class_id<span style='color:#808030; '>)</span> <span style='color:#696969; '># ajout de l'id de l'objet detecte a la liste des IDs des objets detectes</span>

    <span style='color:#696969; '># la fonction suivante supprime d'eventuelles detections multiples d'un meme objet (cf. </span><span style='color:#5555dd; '>https://learnopencv.com/non-maximum-suppression-theory-and-implementation-in-pytorch/</span><span style='color:#696969; '> ) :</span>
    idxs <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>dnn<span style='color:#808030; '>.</span>NMSBoxes<span style='color:#808030; '>(</span>boxes<span style='color:#808030; '>,</span> confidences<span style='color:#808030; '>,</span> SCORE_THRESHOLD<span style='color:#808030; '>,</span> IOU_THRESHOLD<span style='color:#808030; '>)</span>

    <span style='color:#696969; '>#si nous avons au moins un objet detecte</span>
    <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#400000; '>len</span><span style='color:#808030; '>(</span>idxs<span style='color:#808030; '>)</span> <span style='color:#44aadd; '>></span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>:</span>
        <span style='color:#800000; font-weight:bold; '>print</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"objets detectes"</span><span style='color:#808030; '>)</span>
        <span style='color:#696969; '># Iterations dans les donnees recuperees (detections) pour dessin et floutage de l'image</span>
        <span style='color:#800000; font-weight:bold; '>for</span> i <span style='color:#800000; font-weight:bold; '>in</span> idxs<span style='color:#808030; '>.</span>flatten<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
            x<span style='color:#808030; '>,</span> y <span style='color:#808030; '>=</span> boxes<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> boxes<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span> <span style='color:#696969; '># recuperation des coordonnees de l'objet detecte</span>
            w<span style='color:#808030; '>,</span> h <span style='color:#808030; '>=</span> boxes<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>[</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> boxes<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>[</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span> <span style='color:#696969; '># recuperation de la hauteur et de la largeur de l'objet detecte</span>

            <span style='color:#696969; '>#correction necessaire si les valeurs sont negatives:</span>
            <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span>x <span style='color:#44aadd; '>&lt;</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
                x<span style='color:#808030; '>=</span><span style='color:#008c00; '>0</span>
            <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span>y <span style='color:#44aadd; '>&lt;</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
                y <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>

            image <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>rectangle<span style='color:#808030; '>(</span>image<span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span>x<span style='color:#808030; '>,</span> y<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span>x <span style='color:#44aadd; '>+</span> w<span style='color:#808030; '>,</span> y <span style='color:#44aadd; '>+</span> h<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> color<span style='color:#808030; '>=</span><span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> thickness<span style='color:#808030; '>=</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on dessine un rectangle dans l'image a l'endroit de la detection</span>
            text<span style='color:#808030; '>=</span> f<span style='color:#0000e6; '>"{labels[class_ids[i]]}"</span> <span style='color:#696969; '># on prepare le texte (nom de l'objet detecte) pour dessin sur l'image</span>
            image<span style='color:#808030; '>[</span>y<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>y<span style='color:#44aadd; '>+</span>h<span style='color:#808030; '>,</span> x<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>x<span style='color:#44aadd; '>+</span>w<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>blur<span style='color:#808030; '>(</span>image<span style='color:#808030; '>[</span>y<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>y<span style='color:#44aadd; '>+</span>h<span style='color:#808030; '>,</span> x<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>x<span style='color:#44aadd; '>+</span>w<span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span>blurRate<span style='color:#808030; '>,</span> blurRate<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on floute le rectangle de la detection</span>

            <span style='color:#696969; '>#preparation au dessin sur l'image originale (taille originale)</span>
            fx <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>x<span style='color:#44aadd; '>*</span><span style='color:#808030; '>(</span>origw<span style='color:#44aadd; '>/</span>nwidth<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>  <span style='color:#696969; '>#position x de l'objet detecte sur l'image originale</span>
            fy <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>y<span style='color:#44aadd; '>*</span><span style='color:#808030; '>(</span>origh<span style='color:#44aadd; '>/</span>nheight<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '>#position y de l'objet detecte sur l'image originale</span>
            fw <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>w<span style='color:#44aadd; '>*</span><span style='color:#808030; '>(</span>origw<span style='color:#44aadd; '>/</span>nwidth<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '>#largeur de l'objet detecte sur l'image originale</span>
            fh <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>h<span style='color:#44aadd; '>*</span><span style='color:#808030; '>(</span>origh<span style='color:#44aadd; '>/</span>nheight<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '>#longeur de l'objet detecte sur l'image originale</span>

            fullImage <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>rectangle<span style='color:#808030; '>(</span>fullImage<span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span>fx<span style='color:#808030; '>,</span> fy<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span>fx <span style='color:#44aadd; '>+</span> fw<span style='color:#808030; '>,</span> fy <span style='color:#44aadd; '>+</span> fh<span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> color<span style='color:#808030; '>=</span><span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> thickness<span style='color:#808030; '>=</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># dessin d'un rectangle sur l'image originale</span>
            fullBlurRate <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>blurRate<span style='color:#44aadd; '>*</span><span style='color:#808030; '>(</span>origw<span style='color:#44aadd; '>/</span>nwidth<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># mise a l'echelle du taux de floutage</span>
            fullImage<span style='color:#808030; '>[</span>fy<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>fy<span style='color:#44aadd; '>+</span>fh<span style='color:#808030; '>,</span> fx<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>fx<span style='color:#44aadd; '>+</span>fw<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>blur<span style='color:#808030; '>(</span>fullImage<span style='color:#808030; '>[</span>fy<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>fy<span style='color:#44aadd; '>+</span>fh<span style='color:#808030; '>,</span> fx<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>:</span>fx<span style='color:#44aadd; '>+</span>fw<span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>(</span>fullBlurRate<span style='color:#808030; '>,</span> fullBlurRate<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># floutage du rectangle sur l'image originale</span>

            <span style='color:#696969; '># pour ecrire le texte (label de l'objet detecte) sur les images et avec une police de notre choix</span>
            <span style='color:#696969; '># nous devons passer par PIL (la police est chargee, pour l'image reduite, en variable globale au debut du programme (loadedFont))</span>
            im_p <span style='color:#808030; '>=</span> Image<span style='color:#808030; '>.</span>fromarray<span style='color:#808030; '>(</span>image<span style='color:#808030; '>)</span> <span style='color:#696969; '>#trasfert de l'image reduite depuis OpenCV (numpy) vers Pil</span>
            fullim_p <span style='color:#808030; '>=</span> Image<span style='color:#808030; '>.</span>fromarray<span style='color:#808030; '>(</span>fullImage<span style='color:#808030; '>)</span> <span style='color:#696969; '>#trasfert de l'image originale depuis OpenCV (numpy) vers Pil</span>

            draw <span style='color:#808030; '>=</span> ImageDraw<span style='color:#808030; '>.</span>Draw<span style='color:#808030; '>(</span>im_p<span style='color:#808030; '>)</span> <span style='color:#696969; '>#ouverture de l'image reduite pour dessin</span>
            fulldraw <span style='color:#808030; '>=</span> ImageDraw<span style='color:#808030; '>.</span>Draw<span style='color:#808030; '>(</span>fullim_p<span style='color:#808030; '>)</span> <span style='color:#696969; '># ouverture de l'image originale pour dessin</span>

            draw<span style='color:#808030; '>.</span>text<span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>x<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>,</span>y<span style='color:#44aadd; '>-</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>text<span style='color:#808030; '>,</span><span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>font<span style='color:#808030; '>=</span>loadedFont<span style='color:#808030; '>)</span> <span style='color:#696969; '># pose du texte sur l'image reduite</span>

            scaledFontSize <span style='color:#808030; '>=</span> <span style='color:#400000; '>int</span><span style='color:#808030; '>(</span>smallfontSize<span style='color:#44aadd; '>*</span><span style='color:#808030; '>(</span>origw<span style='color:#44aadd; '>/</span>nwidth<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># mise a l'echelle de la taille de la police</span>
            FullFont <span style='color:#808030; '>=</span> ImageFont<span style='color:#808030; '>.</span>truetype<span style='color:#808030; '>(</span>fontFileName<span style='color:#808030; '>,</span>scaledFontSize<span style='color:#808030; '>)</span><span style='color:#696969; '># chargement de la police a taille augmentee</span>
            fulldraw<span style='color:#808030; '>.</span>text<span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>fx<span style='color:#44aadd; '>+</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>,</span>fy<span style='color:#44aadd; '>-</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>text<span style='color:#808030; '>,</span><span style='color:#808030; '>(</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>font<span style='color:#808030; '>=</span>FullFont<span style='color:#808030; '>)</span>  <span style='color:#696969; '># pose du texte sur l'image originale</span>

            fullImage<span style='color:#808030; '>=</span>np<span style='color:#808030; '>.</span>array<span style='color:#808030; '>(</span>fullim_p<span style='color:#808030; '>)</span> <span style='color:#696969; '># conversion depuis Pil vers OpenCV (numpy)</span>
            image <span style='color:#808030; '>=</span> np<span style='color:#808030; '>.</span>array<span style='color:#808030; '>(</span>im_p<span style='color:#808030; '>)</span><span style='color:#696969; '># conversion depuis Pil vers OpenCV (numpy)</span>

        <span style='color:#696969; '># correction des couleurs sur l'image reduite</span>
        b<span style='color:#808030; '>,</span>g<span style='color:#808030; '>,</span>r <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>split<span style='color:#808030; '>(</span>image<span style='color:#808030; '>)</span>
        img <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>merge<span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>r<span style='color:#808030; '>,</span>g<span style='color:#808030; '>,</span>b<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
        imph<span style='color:#808030; '>=</span>Image<span style='color:#808030; '>.</span>fromarray<span style='color:#808030; '>(</span>img<span style='color:#808030; '>)</span> <span style='color:#696969; '># de nouveau depuis openCV vers Pil</span>

        <span style='color:#696969; '># correction des couleurs sur l'image originale</span>
        b<span style='color:#808030; '>,</span>g<span style='color:#808030; '>,</span>r <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>split<span style='color:#808030; '>(</span>fullImage<span style='color:#808030; '>)</span>
        full <span style='color:#808030; '>=</span> cv2<span style='color:#808030; '>.</span>merge<span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>r<span style='color:#808030; '>,</span>g<span style='color:#808030; '>,</span>b<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
        fullImage <span style='color:#808030; '>=</span>Image<span style='color:#808030; '>.</span>fromarray<span style='color:#808030; '>(</span>full<span style='color:#808030; '>)</span> <span style='color:#696969; '># de nouveau depuis openCV vers Pil</span>

        <span style='color:#696969; '>#affichade de l'image reduite sur la fenetre (GUI)</span>
        ph <span style='color:#808030; '>=</span> ImageTk<span style='color:#808030; '>.</span>PhotoImage<span style='color:#808030; '>(</span>image<span style='color:#808030; '>=</span>imph<span style='color:#808030; '>)</span> <span style='color:#696969; '># chargement de l'image reduite</span>
        label_image<span style='color:#808030; '>.</span>configure<span style='color:#808030; '>(</span>image<span style='color:#808030; '>=</span>ph<span style='color:#808030; '>,</span> height<span style='color:#808030; '>=</span>nheight<span style='color:#808030; '>,</span> width<span style='color:#808030; '>=</span>nwidth<span style='color:#808030; '>)</span> <span style='color:#696969; '># configuration du label (espace d'affichage de l'image sur la fenetre)</span>
        label_image<span style='color:#808030; '>.</span>image <span style='color:#808030; '>=</span> ph <span style='color:#696969; '># image a afficher</span>
        label_image<span style='color:#808030; '>.</span>height <span style='color:#808030; '>=</span> nheight <span style='color:#696969; '># hauteur de l'image</span>
        label_image<span style='color:#808030; '>.</span>width <span style='color:#808030; '>=</span> nwidth <span style='color:#696969; '># largeur de l'image</span>
        label_image<span style='color:#808030; '>.</span>place<span style='color:#808030; '>(</span>relx<span style='color:#808030; '>=</span><span style='color:#008000; '>0.5</span><span style='color:#808030; '>,</span> rely<span style='color:#808030; '>=</span><span style='color:#008000; '>0.5</span><span style='color:#808030; '>,</span> anchor<span style='color:#808030; '>=</span>tk<span style='color:#808030; '>.</span>CENTER<span style='color:#808030; '>)</span> <span style='color:#696969; '># placement au centre de la fenetre</span>
        buttSave<span style='color:#808030; '>.</span>configure<span style='color:#808030; '>(</span>command<span style='color:#808030; '>=</span><span style='color:#800000; font-weight:bold; '>lambda</span><span style='color:#808030; '>:</span> saveImage<span style='color:#808030; '>(</span>fullImage<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># mise a jour du bouton d'enregistrement de l'image</span>
        buttSave<span style='color:#808030; '>.</span>command<span style='color:#808030; '>=</span><span style='color:#800000; font-weight:bold; '>lambda</span><span style='color:#808030; '>:</span> saveImage<span style='color:#808030; '>(</span>ph<span style='color:#808030; '>)</span> <span style='color:#696969; '># cliquer sur le bouton fait appel a la foncton saveImage en lui passant l'image floutee de taille originale</span>
        nb<span style='color:#44aadd; '>+</span><span style='color:#808030; '>=</span><span style='color:#008c00; '>1</span> <span style='color:#696969; '># on prepare l'acces a l'image suivante dans la liste</span>
        <span style='color:#800000; font-weight:bold; '>print</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"DONE!"</span><span style='color:#808030; '>)</span>

<span style='color:#696969; '>#cette fonction permet d'enregistrer une image sur le disque dur de l'ordinateur</span>
<span style='color:#800000; font-weight:bold; '>def</span> saveImage<span style='color:#808030; '>(</span>img<span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
    filename <span style='color:#808030; '>=</span> filedialog<span style='color:#808030; '>.</span>asksaveasfile<span style='color:#808030; '>(</span>mode<span style='color:#808030; '>=</span><span style='color:#0000e6; '>'wb'</span><span style='color:#808030; '>,</span> defaultextension<span style='color:#808030; '>=</span><span style='color:#0000e6; '>".jpg"</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># demande a selectioner un fichier ou enregistrer</span>
    <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#800000; font-weight:bold; '>not</span> filename<span style='color:#808030; '>:</span>
         <span style='color:#800000; font-weight:bold; '>print</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"no filename"</span><span style='color:#808030; '>)</span>
         <span style='color:#800000; font-weight:bold; '>return</span>
    img<span style='color:#808030; '>.</span>save<span style='color:#808030; '>(</span>filename<span style='color:#808030; '>)</span> <span style='color:#696969; '># enregistre</span>


<span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#074726; '>__name__</span> <span style='color:#44aadd; '>==</span> <span style='color:#0000e6; '>"__main__"</span><span style='color:#808030; '>:</span> <span style='color:#696969; '># debut du programme</span>
    folder_selected <span style='color:#808030; '>=</span> filedialog<span style='color:#808030; '>.</span>askdirectory<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># demande a selectionner un dossier contenant des images</span>
    filelist<span style='color:#808030; '>=</span>os<span style='color:#808030; '>.</span>listdir<span style='color:#808030; '>(</span>folder_selected<span style='color:#808030; '>)</span> <span style='color:#696969; '># liste les fichiers dans le dossier selectionne</span>

    <span style='color:#800000; font-weight:bold; '>for</span> fichier <span style='color:#800000; font-weight:bold; '>in</span> filelist<span style='color:#808030; '>[</span><span style='color:#808030; '>:</span><span style='color:#808030; '>]</span><span style='color:#808030; '>:</span> <span style='color:#696969; '># ici on retire les fichiers qui ne sont ni jpeg ni png de la liste des fichiers</span>
        <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#800000; font-weight:bold; '>not</span><span style='color:#808030; '>(</span>fichier<span style='color:#808030; '>.</span>endswith<span style='color:#808030; '>(</span><span style='color:#0000e6; '>".jpg"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>and</span> <span style='color:#800000; font-weight:bold; '>not</span><span style='color:#808030; '>(</span>fichier<span style='color:#808030; '>.</span>endswith<span style='color:#808030; '>(</span><span style='color:#0000e6; '>".png"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>and</span> <span style='color:#800000; font-weight:bold; '>not</span><span style='color:#808030; '>(</span>fichier<span style='color:#808030; '>.</span>endswith<span style='color:#808030; '>(</span><span style='color:#0000e6; '>".JPG"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>  <span style='color:#800000; font-weight:bold; '>and</span> <span style='color:#800000; font-weight:bold; '>not</span><span style='color:#808030; '>(</span>fichier<span style='color:#808030; '>.</span>endswith<span style='color:#808030; '>(</span><span style='color:#0000e6; '>".JPEG"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>and</span> <span style='color:#800000; font-weight:bold; '>not</span><span style='color:#808030; '>(</span>fichier<span style='color:#808030; '>.</span>endswith<span style='color:#808030; '>(</span><span style='color:#0000e6; '>".jpeg"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>and</span> <span style='color:#800000; font-weight:bold; '>not</span><span style='color:#808030; '>(</span>fichier<span style='color:#808030; '>.</span>endswith<span style='color:#808030; '>(</span><span style='color:#0000e6; '>".PNG"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>:</span>
            filelist<span style='color:#808030; '>.</span>remove<span style='color:#808030; '>(</span>fichier<span style='color:#808030; '>)</span>

    root<span style='color:#808030; '>.</span>geometry<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"800x800"</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on cree la fenetre du programme et on lui donne la taille 800 x 800</span>
    root<span style='color:#808030; '>.</span>configure<span style='color:#808030; '>(</span>bg<span style='color:#808030; '>=</span><span style='color:#0000e6; '>'black'</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on donne a la fenetre un fond noir</span>

    label_image <span style='color:#808030; '>=</span>  tk<span style='color:#808030; '>.</span>Label<span style='color:#808030; '>(</span>root<span style='color:#808030; '>,</span> bg<span style='color:#808030; '>=</span><span style='color:#0000e6; '>'black'</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on cree un Label permettant l'affichage des images</span>
    label_image<span style='color:#808030; '>.</span>pack<span style='color:#808030; '>(</span>side<span style='color:#808030; '>=</span><span style='color:#0000e6; '>"top"</span><span style='color:#808030; '>,</span> fill<span style='color:#808030; '>=</span><span style='color:#0000e6; '>"both"</span><span style='color:#808030; '>,</span> expand<span style='color:#808030; '>=</span><span style='color:#0000e6; '>"yes"</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on inscrit le Label dans la fenetre</span>

    <span style='color:#696969; '>#on cree un bouton pour se deplacer en arriere dans la liste des fichiers</span>
    butt <span style='color:#808030; '>=</span>  tk<span style='color:#808030; '>.</span>Button<span style='color:#808030; '>(</span>root<span style='color:#808030; '>,</span> text<span style='color:#808030; '>=</span><span style='color:#0000e6; '>"&lt;&lt;"</span><span style='color:#808030; '>,</span> command<span style='color:#808030; '>=</span><span style='color:#800000; font-weight:bold; '>lambda</span><span style='color:#808030; '>:</span> runDetection<span style='color:#808030; '>(</span>folder_selected<span style='color:#808030; '>,</span><span style='color:#44aadd; '>-</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> bg<span style='color:#808030; '>=</span><span style='color:#0000e6; '>'white'</span><span style='color:#808030; '>)</span>
    butt<span style='color:#808030; '>.</span>pack<span style='color:#808030; '>(</span>side<span style='color:#808030; '>=</span> tk<span style='color:#808030; '>.</span>LEFT<span style='color:#808030; '>)</span> <span style='color:#696969; '># on positonne le bouton a gauche dans la fenetre</span>

    <span style='color:#696969; '>#on cree un bouton pour se deplacer en avant dans la liste des fichiers</span>
    butt <span style='color:#808030; '>=</span>  tk<span style='color:#808030; '>.</span>Button<span style='color:#808030; '>(</span>root<span style='color:#808030; '>,</span> text<span style='color:#808030; '>=</span><span style='color:#0000e6; '>">>"</span><span style='color:#808030; '>,</span> command<span style='color:#808030; '>=</span><span style='color:#800000; font-weight:bold; '>lambda</span><span style='color:#808030; '>:</span> runDetection<span style='color:#808030; '>(</span>folder_selected<span style='color:#808030; '>,</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span> bg<span style='color:#808030; '>=</span><span style='color:#0000e6; '>'white'</span><span style='color:#808030; '>)</span>
    butt<span style='color:#808030; '>.</span>pack<span style='color:#808030; '>(</span>side<span style='color:#808030; '>=</span> tk<span style='color:#808030; '>.</span>RIGHT<span style='color:#808030; '>)</span> <span style='color:#696969; '># on positonne le bouton a droite dans la fenetre</span>

    <span style='color:#696969; '>#on cree un bouton pour enregistrer les images si necessaire</span>
    buttSave <span style='color:#808030; '>=</span>  tk<span style='color:#808030; '>.</span>Button<span style='color:#808030; '>(</span>root<span style='color:#808030; '>,</span>text<span style='color:#808030; '>=</span><span style='color:#0000e6; '>"save !"</span><span style='color:#808030; '>,</span> bg<span style='color:#808030; '>=</span><span style='color:#0000e6; '>'white'</span><span style='color:#808030; '>)</span>
    buttSave<span style='color:#808030; '>.</span>pack<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on inscrit le bouton dans la fenetre</span>

    <span style='color:#696969; '>#on lance la detection et l'affichage sur la premiere image de la liste</span>
    runDetection<span style='color:#808030; '>(</span>folder_selected<span style='color:#808030; '>,</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span>

    root<span style='color:#808030; '>.</span>mainloop<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#696969; '># on maintient l'affichage de la fenetre</span>
</pre>
